<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://brl-cad.github.io/wiki/OpenCL_GPGPU_Spatial_Partitioning_Raytracing/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>OpenCL GPGPU Spatial Partitioning Raytracing - BRL-CAD Wiki</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">BRL-CAD Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../DocPages/" class="nav-link">DocPages</a>
                            </li>
                            <li class="navitem">
                                <a href="../UserPages/" class="nav-link">UserPages</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/BRL-CAD/wiki/blob/main/docs/OpenCL_GPGPU_Spatial_Partitioning_Raytracing.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>Contact "brlcad" on irc.freenode.net</p>
<p>BRL-CAD has one of the oldest and fastest parallel ray tracing
implementations around but we don't currently leverage the GPU. With
implicit geometry and constructive solid geometry (CSG) Boolean
operations, we also have a very different approach to ray tracing that
has its own set of academic challenges.</p>
<p>Currently we use a <a href="wikipedia:Bounding_volume_hierarchy.md">Bounding Volume
Hierarchy</a> (BVH), an
object partitioning scheme, to reduce the amount of intersections that
we need to compute on the OpenCL librt. The advantage of the BVH is that
it does not compute duplicate intersections, which is typically an issue
with spatial partitioning schemes. This allows us to use less per thread
memory since we do not require the use of mailboxing . But an issue with
the BVH is that it requires computing all the primitive intersections
along the ray path. This is an issue in scenes with high depth
complexity like Goliath or architectural scenes.</p>
<p>This task requires you to write an ANSI C prototype of a new spatial
partitioning acceleration structure for BRL-CAD and to port this
prototype to OpenCL. The complex construction stage can remain in ANSI C
on the CPU. Then the resulting acceleration structure is copied to the
GPU, in this way only the traversal, i.e. intersection stage, needs to
be ported to OpenCL.</p>
<p>The ANSI C librt uses a BSP tree (really a
<a href="wikipedia:k-d_tree.md">Kd-tree</a>) so that can be used an initial
example. You can also use the PBRT Kd-tree source code as an initial
example. Since we do not want to have duplicate intersections (we have
complex primitives which can take a long time to intersect, also
duplicates would needlessly complicate CSG processing), you would need
to use some kind of Kd-tree hybrid in order to prevent the need for
mailboxing. The issue with mailboxing is that it uses one bit per
primitive in the model per thread. Imagine you have a model with a
million primitives. This would reduce the amount of threads you can have
in-flight (i.e. which can run simultaneously) because of the reduced
cache memory available on a platform like a GPU.</p>
<p>A suitable Kd-tree hybrid which does not compute duplicate intersections
would be either the <a href="wikipedia:Bounding_interval_hierarchy.md">Bounding Interval
Hierarchy</a> (BIH), or a
Kd-tree which stores the larger primitives in the inner nodes, instead
of only storing primitives at the leaf nodes (like the Kd-tree described
by Choi, et al). Alternatively as a first step, you can simply discard
any primitive intersections which are located outside the current
traversed Kd-tree cell, this will eliminate the need for mailboxing, but
will still require the computation of duplicate intersections, and
perhaps complicate the CSG algorithm.</p>
<ul>
<li><a href="https://github.com/mmp/pbrt-v3/tree/master/src/accelerators">https://github.com/mmp/pbrt-v3/tree/master/src/accelerators</a> - PBRT
    source code.</li>
<li><a href="http://grmanet.sogang.ac.kr/ihm/webpapers/1310PG2013.pdf">http://grmanet.sogang.ac.kr/ihm/webpapers/1310PG2013.pdf</a> - Choi's
    Kd-tree presentation.</li>
<li><a href="https://www.highperformancegraphics.net/previous/www_2011/media/Papers/HPG2011_Papers_Wu.pdf">https://www.highperformancegraphics.net/previous/www_2011/media/Papers/HPG2011_Papers_Wu.pdf</a> -
    SAH KD-tree construction on GPU.</li>
</ul>
<p>Difficulty: Hard</p>
<p>Languages: C and OpenCL (or other GPGPU API)</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
