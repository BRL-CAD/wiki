<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://brl-cad.github.io/wiki/doc/Revolve/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Overview - BRL-CAD Wiki</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">BRL-CAD Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../DocPages/" class="nav-link">DocPages</a>
                            </li>
                            <li class="navitem">
                                <a href="../../UserPages/" class="nav-link">UserPages</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/BRL-CAD/wiki/blob/main/pages/doc/Revolve.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#overview" class="nav-link">Overview</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#internal-representation" class="nav-link">Internal Representation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#general-algorithms" class="nav-link">General Algorithms</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#rt_rev_shot-ray-intersection" class="nav-link">rt_rev_shot() - ray intersection</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#rt_rev_norm-surface-normals-hitpoint" class="nav-link">rt_rev_norm() - surface normals @ hitpoint</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#rt_rev_curve-surface-curvature-hitpoint" class="nav-link">rt_rev_curve() - surface curvature @ hitpoint</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#rt_rev_plot-rt_rev_tess" class="nav-link">rt_rev_plot() &amp; rt_rev_tess()</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#additional-features" class="nav-link">Additional Features</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#general-primitive-or-combination" class="nav-link">General Primitive or Combination</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#end-caps" class="nav-link">End Caps</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#complex-end-conditions" class="nav-link">Complex End Conditions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="overview">Overview</h1>
<p>A solid of revolution can be described by its axis of revolution (point
&amp; vector), an angle (-2*pi, 2*pi), and a 2D sketch coplanar with the
axis of revolution. The start and end surfaces will be planes, and a
positive angle is counterclockwise rotation. There are several options
for how to specify the start and end planes. Starseeker suggests using:</p>
<ul>
<li>a vector 'r' such that <axis> x <r> = direction of revolution</li>
<li>an angle</li>
</ul>
<p>In order to analytically solve for the ray/shape intersection points,
the sketch must be limited to splines of at most second order.</p>
<h1 id="internal-representation">Internal Representation</h1>
<p>struct rt_revolve_internal:</p>
<ul>
<li>point_t V3D;</li>
<li>vect_t axis3D;</li>
<li>point2d_t V2D;</li>
<li>vect2d_t axis2D</li>
<li>vect_t r;</li>
<li>fastf_t angle;</li>
<li>char *sketch_name;</li>
<li>struct rt_sketch_internal *sk;</li>
</ul>
<p><em>Questions:</em> Should the sketch be restricted to revolve about its
y-axis, or should I allow for an arbitrary point &amp; axis defined in the
sketch plane (*2D)? If yes, the sketch would undergo a
rotation/translation - is rotation/translation of a sketch already
possible? If it is possible, then restricting to the y-axis will not
limit the user.</p>
<h1 id="general-algorithms">General Algorithms</h1>
<h2 id="rt_rev_shot-ray-intersection">rt_rev_shot() - ray intersection</h2>
<ol>
<li>If (angle != 2*pi) check against the start and end surfaces.<ol>
<li>Find the parameter values for the intersection of the ray with
    the start/end surfaces. These two plane intersections will give
    the bounds on the parameter for intersections. In some cases,
    there will only be an upper or lower bound.</li>
<li>Check if the plane intersection point(s) are inside the 2D
    sketch.</li>
</ol>
</li>
<li>For the revolved portion:<ol>
<li>Flatten out the intersection to 2D (ignore theta): ray becomes
    hyperbola in the r-z plane (parameterized- use same variable for
    length along ray as length along hyperbola to keep mapping from
    3D to 2D)</li>
<li>Check the hyperbola's path against the 2D revolve outline. Find
    the parameter values at the intersection points.</li>
<li>Check the parameter value against the bounds determined in 1.1.</li>
</ol>
</li>
</ol>
<h2 id="rt_rev_norm-surface-normals-hitpoint">rt_rev_norm() - surface normals @ hitpoint</h2>
<ol>
<li>If the hitpoint is on the precomputed 2D revolve outline, the normal
    vector will lie in the r-z plane, and it will also be normal to the
    2D revolve outline.</li>
<li>Otherwise, the hitpoint is on the plane at the start or end of the
    revolve, and the normal vectors for each plane can be stored to
    speed calculations.</li>
</ol>
<h2 id="rt_rev_curve-surface-curvature-hitpoint">rt_rev_curve() - surface curvature @ hitpoint</h2>
<ol>
<li>On the revolved portion (similar to toroid calculation):<ol>
<li>Get the curvature in the r-z plane from the precomputed 2D
    revolve bounds.</li>
<li>Calculate the curvature in the z-theta plane from r.</li>
</ol>
</li>
<li>On the planes at the limits of the revolve, the curvature will be 0.</li>
</ol>
<h2 id="rt_rev_plot-rt_rev_tess">rt_rev_plot() &amp; rt_rev_tess()</h2>
<p>plot() and tess() can be done using the same basic algorithm that the
toroids use, with some modifications:</p>
<ol>
<li>Use the precomputed revolve boundary instead of the ellipse/circle
    for the 2D shape to be revolved.</li>
<li>Add +/- limits to the angle of the revolve.</li>
<li>Add the planes at start and end of revolve (if angle != 2*pi).</li>
</ol>
<h1 id="additional-features">Additional Features</h1>
<h2 id="general-primitive-or-combination">General Primitive or Combination</h2>
<p>Add support for using a 3D primitive or combination as the basis of the
revolve.</p>
<h2 id="end-caps">End Caps</h2>
<p>This would keep the first half of the primitive or group being revolved
at the start plane, and add a copy of the primitive/group to the end. If
this was applied to a cone over 90 degrees, where the cross-section used
for the revolve was a circle, the result would be a frustum attached to
right angle pipe curve, with a cone at the tip.</p>
<h2 id="complex-end-conditions">Complex End Conditions</h2>
<p>This would create a partial revolve (angle &lt; 2*pi) with a 3D shape
where the maximum outline does not fall in a r-z plane. A 2D example of
this is revolving an ellipse with focii at (4,1) and (6, -1) about the z
axis. For this case, the minimum radius and maximum radius do not occur
along the same plane. If the end cap method (above) was used, there
would be an abrubt transition from the ellipse to the revolved body.</p>
<p>This feature can best be implemented by using a sweep along a circular
path, because the sweep primitive will need to handle this end condition
for sweeping any other general 3D primitive. This approach minimizes
code duplication, and keeps the revolve primitive focused specifically
on revolving.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
